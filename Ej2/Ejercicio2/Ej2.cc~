#include "DetectorConstruction.hh"
#include "PhysicsList.hh"
#include "ActionInitialization.hh"

#include "G4RunManager.hh"
#include "G4UImanager.hh"
#include "G4UIExecutive.hh"

#include "G4ScoringManager.hh"
#include "G4VisExecutive.hh"


int main(int arg, char** argv){

  //Run Manager
  G4RunManager* runManager = new G4RunManager;
  
  //Initialization classes

  runManager->SetUserInitialization(new DetectorConstruction);
  runManager->SetUserInitialization(new PhysicsList);
  runManager->SetUserInitialization(new ActionInitialization);

  runManager->Initialize();

  //Vis Manager
  G4VisExecutive* visManager = new G4VisExecutive;
  visManager->Initialize();
  
  //Score Manager
  G4ScoringManager* scoreManager = G4ScoringManager::GetScoringManager();
  
  //UI Manager
  G4UImanager*UI=G4UImanager::GetUIpointer();

  if (arg==1){
    G4UIExecutive* ui =new G4UIExecutive(arg, argv);
    UI->ApplyCommand("/control/execute /macros/init.mac");
    ui->SessionStart();
    delete ui;
  }
  else {
    G4String command = "/control/execute";
    G4String file = argv[1];
    UI->ApplyCommand(command + file);
  }

  delete scoreManager;
  delete visManager;
  delete runManager;
  return 0;
    
}
